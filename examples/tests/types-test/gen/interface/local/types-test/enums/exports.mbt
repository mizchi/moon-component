// Generated by wit-bindgen-moonbit

///|
pub enum Color {
  Red
  Green
  Blue
} derive(Show, Eq)

///| Lift Color from ordinal
pub fn Color::from_ordinal(ordinal : Int) -> Color {
  match ordinal {
    0 => Red
    1 => Green
    2 => Blue
    _ => abort("invalid enum ordinal")
  }
}

///| Lower Color to ordinal
pub fn Color::ordinal(self : Color) -> Int {
  match self {
    Red => 0
    Green => 1
    Blue => 2
  }
}

/// Export trait for enums
pub(open) trait Exports {
  color_name(Self, c : Color) -> String
  echo_color(Self, c : Color) -> Color
}

let exports_impl : Ref[&Exports?] = { val: None }

pub fn register(impl_ : &Exports) -> Unit {
  exports_impl.val = Some(impl_)
}

pub fn get_exports() -> &Exports {
  guard exports_impl.val is Some(impl_) else {
    abort("exports not registered")
  }
  impl_
}

pub fn wasmExportColorName(c : Int) -> Int {
  let c : Color = Color::from_ordinal(c)
  let result = get_exports().color_name(c)
  let (ptr, len) = @cabi.cabi_lower_string(result)
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  @cabi.cabi_write_i32(retptr, ptr)
  @cabi.cabi_write_i32(retptr + 4, len)
  retptr
}

pub fn wasmExportEchoColor(c : Int) -> Int {
  let c : Color = Color::from_ordinal(c)
  get_exports().echo_color(c).ordinal()
}

