// Generated by wit-bindgen-moonbit

/// Export trait for multi-params
pub(open) trait Exports {
  add2(Self, a : Int, b : Int) -> Int
  add3(Self, a : Int, b : Int, c : Int) -> Int
  add4(Self, a : Int, b : Int, c : Int, d : Int) -> Int
  concat3(Self, a : String, b : String, c : String) -> String
  mixed_params(Self, n : Int, s : String, b : Bool) -> String
}

let exports_impl : Ref[&Exports?] = { val: None }

pub fn register(impl_ : &Exports) -> Unit {
  exports_impl.val = Some(impl_)
}

pub fn get_exports() -> &Exports {
  guard exports_impl.val is Some(impl_) else {
    abort("exports not registered")
  }
  impl_
}

pub fn wasmExportAdd2(a : Int, b : Int) -> Int {
  get_exports().add2(a, b)
}

pub fn wasmExportAdd3(a : Int, b : Int, c : Int) -> Int {
  get_exports().add3(a, b, c)
}

pub fn wasmExportAdd4(a : Int, b : Int, c : Int, d : Int) -> Int {
  get_exports().add4(a, b, c, d)
}

pub fn wasmExportConcat3(a_ptr : Int, a_len : Int, b_ptr : Int, b_len : Int, c_ptr : Int, c_len : Int) -> Int {
  let a = @cabi.cabi_lift_string(a_ptr, a_len)
  let b = @cabi.cabi_lift_string(b_ptr, b_len)
  let c = @cabi.cabi_lift_string(c_ptr, c_len)
  let result = get_exports().concat3(a, b, c)
  let (ptr, len) = @cabi.cabi_lower_string(result)
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  @cabi.cabi_write_i32(retptr, ptr)
  @cabi.cabi_write_i32(retptr + 4, len)
  retptr
}

pub fn wasmExportMixedParams(n : Int, s_ptr : Int, s_len : Int, b : Bool) -> Int {
  let s = @cabi.cabi_lift_string(s_ptr, s_len)
  let result = get_exports().mixed_params(n, s, b)
  let (ptr, len) = @cabi.cabi_lower_string(result)
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  @cabi.cabi_write_i32(retptr, ptr)
  @cabi.cabi_write_i32(retptr + 4, len)
  retptr
}

